# Курсовая 8. Docker (Трекер полезных привычек)

## Описание работы
- Для разных сервисов создать отдельные контейнеры 
  - (django, postgresql, redis, celery)
- Всё оформить в файле docker-compose
- Проект готов быть размещенным на удаленном сервере: 
    - Собрать командой ```docker-compose build``` 
    - Запустить командой ```docker-compose up```


# Исходником служит работа из курсовой 7, где реализована следующая структура:

## Для работы с проектом необходимо выполнить следующие действия:

- Клонировать репозиторий.
- Установить виртуальное окружение venv
- Установить зависимости pip install -r requirements.txt
- Создать файл .env, заполнить его данными из файла .env.sample, прописать токен своего телеграм бота
- Создать базу данных в PostreSQL (CREATE DATABASE) skypro_cw8
- Создать миграции (python manage.py makemigrate) и применить (python manage.py migrate)
- Создать суперпользователя командой python manage.py csu
- Установить и запустить Redis локально (на Windows)
- Запустить через терминал проект python manage.py runserver
- Во втором терминале запустить celery -A config worker -l INFO -P eventlet
- В третьем терминале запустить celery celery -A config beat -l info
- Для доступа к приложению перейти в браузере по адресу http://127.0.0.1:8000
- Для реализации получения сообщений в Telegram, необходимо при создании пользователя указать ID -пользователя телеграм

## Описание задач курсовой

- Добавьте необходимые модели привычек.
- Реализуйте эндпоинты для работы с фронтендом.
- Создайте приложение для работы с Telegram и рассылками напоминаний.

## Модель Привычка:

- Пользователь — создатель привычки.
- Место — место, в котором необходимо выполнять привычку.
- Время — время, когда необходимо выполнять привычку.
- Действие — действие, которое представляет из себя привычка.
- Признак приятной привычки — привычка, которую можно привязать к выполнению полезной привычки.
- Связанная привычка — привычка, которая связана с другой привычкой, важно указывать для полезных привычек, но не для приятных.
- Периодичность (по умолчанию ежедневная) — периодичность выполнения привычки для напоминания в днях.
- Вознаграждение — чем пользователь должен себя вознаградить после выполнения.
- Время на выполнение — время, которое предположительно потратит пользователь на выполнение привычки.
- Признак публичности — привычки можно публиковать в общий доступ, чтобы другие пользователи могли брать в пример чужие привычки.

## Модель Пользователь:

- email, (имя пользователя)
- chat_id, (id чата в телеграмм)
- telegram_user_name, (имя в телеграмм)
  
## Валидаторы

- Исключить одновременный выбор связанной привычки и указания вознаграждения.
- Время выполнения должно быть не больше 120 секунд.
- В связанные привычки могут попадать только привычки с признаком приятной привычки.
- У приятной привычки не может быть вознаграждения или связанной привычки.
- Нельзя выполнять привычку реже, чем 1 раз в 7 дней.

## Пагинация

Для вывода списка привычек реализовать пагинацию с выводом по 5 привычек на страницу.

## Права доступа

- Каждый пользователь имеет доступ только к своим привычкам по механизму CRUD.
- Пользователь может видеть список публичных привычек без возможности их как-то редактировать или удалять.

## Эндпоинты

- Регистрация
- Авторизация
- Список привычек текущего пользователя с пагинацией
- Список публичных привычек с пагинацией
- Создание привычки
- Редактирование привычки
- Удаление привычки

## Интеграция

Для полноценной работы сервиса необходим реализовать работу с отложенными задачами для напоминания о том, в какое время какие привычки необходимо выполнять.
Для этого потребуется интегрировать сервис с мессенджером Telegram, который будет заниматься рассылкой уведомлений.

## Безопасность

Для проекта необходимо настроить CORS, чтобы фронтенд мог подключаться к проекту на развернутом сервере.

## Документация

Для реализации экранов силами фронтенд-разработчиков необходимо настроить вывод документации. При необходимости эндпоинты, на которые документация не будет сгенерирована автоматически, описать вручную.

Документация для API реализована с помощью drf-yasg и находится на следующих эндпоинтах:

- http://127.0.0.1:8000/docs/
- http://127.0.0.1:8000/redoc/

## Тестирование проекта

Для тестирования проекта запустить команду: python manage.py test
